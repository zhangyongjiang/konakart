<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_29) on Wed Aug 27 11:46:11 BST 2014 -->
<TITLE>
PromotionMgr (KonaKart Server Engine API Documentation)
</TITLE>

<META NAME="date" CONTENT="2014-08-27">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="PromotionMgr (KonaKart Server Engine API Documentation)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../com/konakart/bl/ProductMgrEE.html" title="class in com.konakart.bl"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../com/konakart/bl/PromotionMgr.StaticData.html" title="class in com.konakart.bl"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?com/konakart/bl/PromotionMgr.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PromotionMgr.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
com.konakart.bl</FONT>
<BR>
Class PromotionMgr</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><A HREF="../../../com/konakart/bl/BaseMgr.html" title="class in com.konakart.bl">com.konakart.bl.BaseMgr</A>
      <IMG SRC="../../../resources/inherit.gif" ALT="extended by "><B>com.konakart.bl.PromotionMgr</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public class <B>PromotionMgr</B><DT>extends <A HREF="../../../com/konakart/bl/BaseMgr.html" title="class in com.konakart.bl">BaseMgr</A><DT>implements <A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></DL>
</PRE>

<P>
Promotions Manager
<P>

<P>
<HR>

<P>
<!-- ======== NESTED CLASS SUMMARY ======== -->

<A NAME="nested_class_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Nested Class Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;class</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.StaticData.html" title="class in com.konakart.bl">PromotionMgr.StaticData</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used to store the static data of this manager</TD>
</TR>
</TABLE>
&nbsp;<!-- =========== FIELD SUMMARY =========== -->

<A NAME="field_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Field Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#ALL">ALL</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant for Promotion Rule</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#COUPON_DOESNT_EXIST">COUPON_DOESNT_EXIST</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coupon doesn't exist</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#COUPON_EXISTS_ACTIVE">COUPON_EXISTS_ACTIVE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coupon exists and is active</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#COUPON_EXISTS_INACTIVE">COUPON_EXISTS_INACTIVE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coupon exists but is no longer active</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#EXCLUDE">EXCLUDE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant for Promotion Rule</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#GIFT_CERTIFICATE_RELATION_TYPE">GIFT_CERTIFICATE_RELATION_TYPE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant for Promotion To Product Relation</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#INCLUDE">INCLUDE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant for Promotion Rule</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;org.apache.commons.logging.Log</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#log">log</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the log</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#mutex">mutex</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#PROMOTION_RELATION_TYPE">PROMOTION_RELATION_TYPE</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constant for Promotion To Product Relation</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected static&nbsp;java.util.Map&lt;java.lang.String,<A HREF="../../../com/konakart/bl/PromotionMgr.StaticData.html" title="class in com.konakart.bl">PromotionMgr.StaticData</A>&gt;</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#staticDataHM">staticDataHM</A></B></CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hash Map that contains the static data</TD>
</TR>
</TABLE>
&nbsp;<A NAME="fields_inherited_from_class_com.konakart.bl.BaseMgr"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Fields inherited from class com.konakart.bl.<A HREF="../../../com/konakart/bl/BaseMgr.html" title="class in com.konakart.bl">BaseMgr</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../com/konakart/bl/BaseMgr.html#templateBaseDir">templateBaseDir</A></CODE></TD>
</TR>
</TABLE>
&nbsp;
<!-- ======== CONSTRUCTOR SUMMARY ======== -->

<A NAME="constructor_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Constructor Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#PromotionMgr(com.konakart.appif.KKEngIf)">PromotionMgr</A></B>(<A HREF="../../../com/konakart/appif/KKEngIf.html" title="interface in com.konakart.appif">KKEngIf</A>&nbsp;eng)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Constructor</TD>
</TR>
</TABLE>
&nbsp;
<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#applyDiscount(com.konakart.appif.ProductIf, com.konakart.appif.PromotionResultIf, com.konakart.appif.PromotionOptionsIf)">applyDiscount</A></B>(<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod,
              <A HREF="../../../com/konakart/appif/PromotionResultIf.html" title="interface in com.konakart.appif">PromotionResultIf</A>&nbsp;promResult,
              <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apply the promotion discount to a product</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCategory(com.konakart.app.Promotion, com.konakart.appif.ProductIf)">checkCategory</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
              <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We check to see whether the product category is a category that can use the promotion.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCoupon(com.konakart.app.Promotion, com.konakart.app.Order)">checkCoupon</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
            <A HREF="../../../com/konakart/app/Order.html" title="class in com.konakart.app">Order</A>&nbsp;order)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the promotion requires a coupon, we try and find one or more active coupons for the
 promotion that have a coupon code equal to the one in the order.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCoupon(com.konakart.app.Promotion, java.lang.String[])">checkCoupon</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
            java.lang.String[]&nbsp;coupons)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the promotion requires a coupon, we try and find one or more active coupons for the
 promotion that have a coupon code equal to one of the ones the array.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCoupon(java.lang.String)">checkCoupon</A></B>(java.lang.String&nbsp;couponCode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method is used to verify whether a coupon code actually exists and if it does, whether
 the coupon is still active.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCustomer(com.konakart.app.Promotion, int)">checkCustomer</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
              int&nbsp;customerId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We check to see whether the customer submitting the order is a customer that can use the
 promotion.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCustomerGroup(com.konakart.app.Promotion, int)">checkCustomerGroup</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                   int&nbsp;customerId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We check to see whether the group of the customer submitting the order is a group that can
 use the promotion.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkCustomerUse(com.konakart.app.Promotion, int)">checkCustomerUse</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                 int&nbsp;customerId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the promotion has the maxUse attribute set to a positive value, then we check to see
 whether the customer can still use the promotion or whether he has already used it the
 maximum number of times allowed.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkExpression(com.konakart.app.Promotion, int)">checkExpression</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                int&nbsp;customerId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We check to see whether the expression evaluates to TRUE</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkManufacturer(com.konakart.app.Promotion, com.konakart.appif.ProductIf)">checkManufacturer</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                  <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We check to see whether the product manufacturer is a manufacturer that can use the
 promotion.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkProduct(com.konakart.app.Promotion, com.konakart.appif.OrderProductIf)">checkProduct</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
             <A HREF="../../../com/konakart/appif/OrderProductIf.html" title="interface in com.konakart.appif">OrderProductIf</A>&nbsp;orderProd)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We check to see whether the product is a product that can use the promotion.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#checkPromotion(com.konakart.app.Promotion)">checkPromotion</A></B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Checks the validity of the promotion object.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getAllPromotions()">getAllPromotions</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an array of all active promotions</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/konakart/app/Coupon.html" title="class in com.konakart.app">Coupon</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getCouponPerId(int, com.konakart.appif.CouponOptionsIf)">getCouponPerId</A></B>(int&nbsp;couponId,
               <A HREF="../../../com/konakart/appif/CouponOptionsIf.html" title="interface in com.konakart.appif">CouponOptionsIf</A>&nbsp;options)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a coupon for the coupon id passed in as a parameter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/konakart/app/Coupon.html" title="class in com.konakart.app">Coupon</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getCouponsPerCode(java.lang.String, com.konakart.appif.CouponOptionsIf)">getCouponsPerCode</A></B>(java.lang.String&nbsp;couponCode,
                  <A HREF="../../../com/konakart/appif/CouponOptionsIf.html" title="interface in com.konakart.appif">CouponOptionsIf</A>&nbsp;options)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns an array of coupons for the coupon code passed in as a parameter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getCustomerId(java.lang.String, int)">getCustomerId</A></B>(java.lang.String&nbsp;sessionId,
              int&nbsp;customerId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the sessionId is null, we check the customerId to ensure that it is negative.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../com/konakart/app/OrderProduct.html" title="class in com.konakart.app">OrderProduct</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getOrderProductsFromProduct(com.konakart.appif.ProductIf)">getOrderProductsFromProduct</A></B>(<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates OrderProducts from a product so that we can reuse the checkProduct() method.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotionIdForGiftCertificate(int, int, int)">getPromotionIdForGiftCertificate</A></B>(int&nbsp;productId,
                                 int&nbsp;productOptionId,
                                 int&nbsp;productOptionValueId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Protected method for common code to get the promotion id of a promotion connected to a gift
 certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotionIdForGiftCertificate(com.konakart.appif.OrderProductIf)">getPromotionIdForGiftCertificate</A></B>(<A HREF="../../../com/konakart/appif/OrderProductIf.html" title="interface in com.konakart.appif">OrderProductIf</A>&nbsp;op)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Get the promotion id for an order product object containing a gift certificate.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../com/konakart/appif/PromotionResultIf.html" title="interface in com.konakart.appif">PromotionResultIf</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotionResultArray(com.konakart.appif.PromotionResultIf[], com.konakart.app.PromotionResult)">getPromotionResultArray</A></B>(<A HREF="../../../com/konakart/appif/PromotionResultIf.html" title="interface in com.konakart.appif">PromotionResultIf</A>[]&nbsp;currentArray,
                        <A HREF="../../../com/konakart/app/PromotionResult.html" title="class in com.konakart.app">PromotionResult</A>&nbsp;newResult)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Utility method to add a PromotionResult object on to the end of an array</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotions(java.lang.String, com.konakart.app.Order)">getPromotions</A></B>(java.lang.String&nbsp;orderTotalCode,
              <A HREF="../../../com/konakart/app/Order.html" title="class in com.konakart.app">Order</A>&nbsp;order)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We return all active promotions for the orderTotalCode passed in as a parameter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotionsPerCoupon(java.lang.String, int, com.konakart.appif.PromotionOptionsIf)">getPromotionsPerCoupon</A></B>(java.lang.String&nbsp;couponCode,
                       int&nbsp;couponId,
                       <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method is used to return an array of promotions associated with the coupon(s) identified
 by the input parameters.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotionsPerOrderTotalCode(java.lang.String)">getPromotionsPerOrderTotalCode</A></B>(java.lang.String&nbsp;orderTotalCode)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The promotions related to the orderTotalCode passed in as a parameter, are fetched from the
 database.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>[]</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#getPromotionsPerProducts(java.lang.String, int, com.konakart.appif.ProductIf[], com.konakart.appif.PromotionIf[], java.lang.String[], com.konakart.appif.PromotionOptionsIf)">getPromotionsPerProducts</A></B>(java.lang.String&nbsp;sessionId,
                         int&nbsp;customerId,
                         <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>[]&nbsp;products,
                         <A HREF="../../../com/konakart/appif/PromotionIf.html" title="interface in com.konakart.appif">PromotionIf</A>[]&nbsp;promotions,
                         java.lang.String[]&nbsp;couponCodes,
                         <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This method is used to calculate a discount on individual products so that the discount can
 be displayed without having to add the product to the cart.<br>
 The method receives an array of products and returns an array of products with attached
 PromotionResult objects that contain the results of one or more of the promotions passed in
 as a parameter.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;int</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#insertCoupon(com.konakart.appif.CouponIf, int)">insertCoupon</A></B>(<A HREF="../../../com/konakart/appif/CouponIf.html" title="interface in com.konakart.appif">CouponIf</A>&nbsp;coupon,
             int&nbsp;promotionId)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Insert a coupon and associate it with the promotion referenced by promotionId.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#processPrice(com.konakart.appif.ProductIf, com.konakart.appif.PromotionOptionsIf)">processPrice</A></B>(<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod,
             <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We apply the discount to a product, taking into consideration the rules to decide which
 promotion discount to select</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#refreshConfigs()">refreshConfigs</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Refresh the configuration of the Promotion manager</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#setCouponCriteriaWithStandardAttributes(com.konakart.db.KKCriteria)">setCouponCriteriaWithStandardAttributes</A></B>(<A HREF="../../../com/konakart/db/KKCriteria.html" title="class in com.konakart.db">KKCriteria</A>&nbsp;c)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the criteria object with all of the attributes for a coupon</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#setPromotionCriteriaWithStandardAttributes(com.konakart.db.KKCriteria)">setPromotionCriteriaWithStandardAttributes</A></B>(<A HREF="../../../com/konakart/db/KKCriteria.html" title="class in com.konakart.db">KKCriteria</A>&nbsp;c)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Set the criteria object with all of the attributes for a promotion</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#updatePromotionUsage(com.konakart.app.Order)">updatePromotionUsage</A></B>(<A HREF="../../../com/konakart/app/Order.html" title="class in com.konakart.app">Order</A>&nbsp;order)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If the order has any associated coupons we iterate through the coupons and increment the
 timesUsed attribute.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>protected &nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../com/konakart/bl/PromotionMgr.html#validateCoupon(com.konakart.appif.CouponIf)">validateCoupon</A></B>(<A HREF="../../../com/konakart/appif/CouponIf.html" title="interface in com.konakart.appif">CouponIf</A>&nbsp;coupon)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Used to validate a coupon before inserting</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_com.konakart.bl.BaseMgr"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class com.konakart.bl.<A HREF="../../../com/konakart/bl/BaseMgr.html" title="class in com.konakart.bl">BaseMgr</A></B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE><A HREF="../../../com/konakart/bl/BaseMgr.html#addInsertAttr(org.apache.torque.util.Criteria, java.lang.String, int)">addInsertAttr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#addInsertAttr(org.apache.torque.util.Criteria, java.lang.String, java.lang.Object)">addInsertAttr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#addStringRuleConstraint(com.konakart.db.KKCriteria, java.lang.String, int, org.apache.torque.Column)">addStringRuleConstraint</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#addStringRuleConstraint(com.konakart.db.KKCriteria, java.lang.String, int, java.lang.String)">addStringRuleConstraint</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#checkRequired(java.lang.Object, java.lang.String, java.lang.String)">checkRequired</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#executeQuery(java.lang.String)">executeQuery</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#executeQuery(java.lang.String, int, int, java.lang.String, boolean)">executeQuery</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#executeQuery(java.lang.String, int, int, java.lang.String, boolean, boolean, java.lang.String)">executeQuery</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#executeQuery(java.lang.String, int, int, java.lang.String, boolean, boolean, java.lang.String, java.util.List)">executeQuery</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#executeQuery(java.lang.String, java.util.List)">executeQuery</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getAdminEngMgr()">getAdminEngMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getBasketMgr()">getBasketMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getBillingMgr()">getBillingMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getBookableProductMgr()">getBookableProductMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCacheMgr()">getCacheMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCatMgr()">getCatMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getConfigMgr()">getConfigMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCookieMgr()">getCookieMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCurrMgr()">getCurrMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCustMgr()">getCustMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCustomerIdFromSession(java.lang.String)">getCustomerIdFromSession</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCustomerStatsMgr()">getCustomerStatsMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getCustomerTagMgr()">getCustomerTagMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getEmailMgr()">getEmailMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getEng()">getEng</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getEventMgr()">getEventMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getKonaKartConfig(java.lang.String, boolean)">getKonaKartConfig</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getLangMgr()">getLangMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getManuMgr()">getManuMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getMiscItemMgr()">getMiscItemMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getMiscPriceMgr()">getMiscPriceMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getMode()">getMode</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getModeString()">getModeString</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getMqMgr()">getMqMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getMultiStoreMgr()">getMultiStoreMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getNewCriteria()">getNewCriteria</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getNewCriteria(boolean)">getNewCriteria</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getOrderIntegrationMgr()">getOrderIntegrationMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getOrderMgr()">getOrderMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getOrderTotalMgr()">getOrderTotalMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getPaymentMgr()">getPaymentMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getProdMgr()">getProdMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getPromMgr()">getPromMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getPunchOutMgr()">getPunchOutMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getRewardPointMgr()">getRewardPointMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getSecMgr()">getSecMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getShippingMgr()">getShippingMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getSolrMgr()">getSolrMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getStoreId()">getStoreId</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getStoreMgr()">getStoreMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getTaxMgr()">getTaxMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getTemplate(org.apache.velocity.app.VelocityEngine, java.lang.String, java.lang.String)">getTemplate</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getTemplateRoot(java.lang.String)">getTemplateRoot</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getVelocityContextMgr()">getVelocityContextMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#getWishListMgr()">getWishListMgr</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#init(com.konakart.appif.KKEngIf, org.apache.commons.logging.Log)">init</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#insertKKEvent(int, int, int)">insertKKEvent</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#insertKKEvent(int, int, java.lang.String)">insertKKEvent</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#isDeadlockException(java.sql.SQLException)">isDeadlockException</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#isEnterprise()">isEnterprise</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#isMultiStoreShareCategories()">isMultiStoreShareCategories</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#isMultiStoreShareCustomers()">isMultiStoreShareCustomers</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#isMultiStoreSharedDb()">isMultiStoreSharedDb</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#isMultiStoreShareProducts()">isMultiStoreShareProducts</A>, <A HREF="../../../com/konakart/bl/BaseMgr.html#manageThrowable(java.lang.Throwable)">manageThrowable</A></CODE></TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ FIELD DETAIL =========== -->

<A NAME="field_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Field Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="log"><!-- --></A><H3>
log</H3>
<PRE>
protected static org.apache.commons.logging.Log <B>log</B></PRE>
<DL>
<DD>the log
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="mutex"><!-- --></A><H3>
mutex</H3>
<PRE>
protected static java.lang.String <B>mutex</B></PRE>
<DL>
<DL>
</DL>
</DL>
<HR>

<A NAME="staticDataHM"><!-- --></A><H3>
staticDataHM</H3>
<PRE>
protected static java.util.Map&lt;java.lang.String,<A HREF="../../../com/konakart/bl/PromotionMgr.StaticData.html" title="class in com.konakart.bl">PromotionMgr.StaticData</A>&gt; <B>staticDataHM</B></PRE>
<DL>
<DD>Hash Map that contains the static data
<P>
<DL>
</DL>
</DL>
<HR>

<A NAME="ALL"><!-- --></A><H3>
ALL</H3>
<PRE>
public static final int <B>ALL</B></PRE>
<DL>
<DD>Constant for Promotion Rule
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.ALL">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="EXCLUDE"><!-- --></A><H3>
EXCLUDE</H3>
<PRE>
public static final int <B>EXCLUDE</B></PRE>
<DL>
<DD>Constant for Promotion Rule
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.EXCLUDE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="INCLUDE"><!-- --></A><H3>
INCLUDE</H3>
<PRE>
public static final int <B>INCLUDE</B></PRE>
<DL>
<DD>Constant for Promotion Rule
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.INCLUDE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="PROMOTION_RELATION_TYPE"><!-- --></A><H3>
PROMOTION_RELATION_TYPE</H3>
<PRE>
protected static final int <B>PROMOTION_RELATION_TYPE</B></PRE>
<DL>
<DD>Constant for Promotion To Product Relation
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.PROMOTION_RELATION_TYPE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="GIFT_CERTIFICATE_RELATION_TYPE"><!-- --></A><H3>
GIFT_CERTIFICATE_RELATION_TYPE</H3>
<PRE>
protected static final int <B>GIFT_CERTIFICATE_RELATION_TYPE</B></PRE>
<DL>
<DD>Constant for Promotion To Product Relation
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.GIFT_CERTIFICATE_RELATION_TYPE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="COUPON_DOESNT_EXIST"><!-- --></A><H3>
COUPON_DOESNT_EXIST</H3>
<PRE>
public static final int <B>COUPON_DOESNT_EXIST</B></PRE>
<DL>
<DD>Coupon doesn't exist
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.COUPON_DOESNT_EXIST">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="COUPON_EXISTS_ACTIVE"><!-- --></A><H3>
COUPON_EXISTS_ACTIVE</H3>
<PRE>
public static final int <B>COUPON_EXISTS_ACTIVE</B></PRE>
<DL>
<DD>Coupon exists and is active
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.COUPON_EXISTS_ACTIVE">Constant Field Values</A></DL>
</DL>
<HR>

<A NAME="COUPON_EXISTS_INACTIVE"><!-- --></A><H3>
COUPON_EXISTS_INACTIVE</H3>
<PRE>
public static final int <B>COUPON_EXISTS_INACTIVE</B></PRE>
<DL>
<DD>Coupon exists but is no longer active
<P>
<DL>
<DT><B>See Also:</B><DD><A HREF="../../../constant-values.html#com.konakart.bl.PromotionMgr.COUPON_EXISTS_INACTIVE">Constant Field Values</A></DL>
</DL>

<!-- ========= CONSTRUCTOR DETAIL ======== -->

<A NAME="constructor_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Constructor Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="PromotionMgr(com.konakart.appif.KKEngIf)"><!-- --></A><H3>
PromotionMgr</H3>
<PRE>
public <B>PromotionMgr</B>(<A HREF="../../../com/konakart/appif/KKEngIf.html" title="interface in com.konakart.appif">KKEngIf</A>&nbsp;eng)
             throws java.lang.Exception</PRE>
<DL>
<DD>Constructor
<P>
<DL>
<DT><B>Parameters:</B><DD><CODE>eng</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DL>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getPromotions(java.lang.String, com.konakart.app.Order)"><!-- --></A><H3>
getPromotions</H3>
<PRE>
public <A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[] <B>getPromotions</B>(java.lang.String&nbsp;orderTotalCode,
                                 <A HREF="../../../com/konakart/app/Order.html" title="class in com.konakart.app">Order</A>&nbsp;order)
                          throws java.lang.Exception</PRE>
<DL>
<DD>We return all active promotions for the orderTotalCode passed in as a parameter. The
 promotion may only apply for a subset of the products within the order so we return this
 information as an attribute of the Promotion object.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getPromotions(java.lang.String, com.konakart.app.Order)">getPromotions</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>orderTotalCode</CODE> - <DD><CODE>order</CODE> - 
<DT><B>Returns:</B><DD>An array of promotion objects
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getAllPromotions()"><!-- --></A><H3>
getAllPromotions</H3>
<PRE>
public <A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[] <B>getAllPromotions</B>()
                             throws java.lang.Exception</PRE>
<DL>
<DD>Returns an array of all active promotions
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getAllPromotions()">getAllPromotions</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>Returns an array of all active promotions
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkPromotion(com.konakart.app.Promotion)"><!-- --></A><H3>
checkPromotion</H3>
<PRE>
protected boolean <B>checkPromotion</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm)</PRE>
<DL>
<DD>Checks the validity of the promotion object.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - 
<DT><B>Returns:</B><DD>Returns true if valid. Otherwise false.</DL>
</DD>
</DL>
<HR>

<A NAME="checkCustomer(com.konakart.app.Promotion, int)"><!-- --></A><H3>
checkCustomer</H3>
<PRE>
protected int <B>checkCustomer</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                            int&nbsp;customerId)
                     throws com.workingdogs.village.DataSetException,
                            org.apache.torque.TorqueException</PRE>
<DL>
<DD>We check to see whether the customer submitting the order is a customer that can use the
 promotion. He may have to be included explicitly or may have been excluded.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>customerId</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the customer can use the promotion. Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkCustomerUse(com.konakart.app.Promotion, int)"><!-- --></A><H3>
checkCustomerUse</H3>
<PRE>
protected int <B>checkCustomerUse</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                               int&nbsp;customerId)
                        throws com.workingdogs.village.DataSetException,
                               org.apache.torque.TorqueException</PRE>
<DL>
<DD>If the promotion has the maxUse attribute set to a positive value, then we check to see
 whether the customer can still use the promotion or whether he has already used it the
 maximum number of times allowed.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>customerId</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the customer can use the promotion. Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkCustomerGroup(com.konakart.app.Promotion, int)"><!-- --></A><H3>
checkCustomerGroup</H3>
<PRE>
protected int <B>checkCustomerGroup</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                                 int&nbsp;customerId)
                          throws java.lang.Exception</PRE>
<DL>
<DD>We check to see whether the group of the customer submitting the order is a group that can
 use the promotion.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>customerId</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the customer can use the promotion. Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkManufacturer(com.konakart.app.Promotion, com.konakart.appif.ProductIf)"><!-- --></A><H3>
checkManufacturer</H3>
<PRE>
protected int <B>checkManufacturer</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                                <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod)
                         throws com.workingdogs.village.DataSetException,
                                org.apache.torque.TorqueException</PRE>
<DL>
<DD>We check to see whether the product manufacturer is a manufacturer that can use the
 promotion.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>prod</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the manufacturer can use the promotion. Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkProduct(com.konakart.app.Promotion, com.konakart.appif.OrderProductIf)"><!-- --></A><H3>
checkProduct</H3>
<PRE>
protected int <B>checkProduct</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                           <A HREF="../../../com/konakart/appif/OrderProductIf.html" title="interface in com.konakart.appif">OrderProductIf</A>&nbsp;orderProd)
                    throws com.workingdogs.village.DataSetException,
                           org.apache.torque.TorqueException</PRE>
<DL>
<DD>We check to see whether the product is a product that can use the promotion. The order
 product may contain an array of options so we have to consider each option separately.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>orderProd</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the orderProd can use the promotion. Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkCategory(com.konakart.app.Promotion, com.konakart.appif.ProductIf)"><!-- --></A><H3>
checkCategory</H3>
<PRE>
protected int <B>checkCategory</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                            <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod)
                     throws java.lang.Exception</PRE>
<DL>
<DD>We check to see whether the product category is a category that can use the promotion.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>prod</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the category can use the promotion. Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkCoupon(com.konakart.app.Promotion, com.konakart.app.Order)"><!-- --></A><H3>
checkCoupon</H3>
<PRE>
protected int <B>checkCoupon</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                          <A HREF="../../../com/konakart/app/Order.html" title="class in com.konakart.app">Order</A>&nbsp;order)
                   throws com.workingdogs.village.DataSetException,
                          org.apache.torque.TorqueException</PRE>
<DL>
<DD>If the promotion requires a coupon, we try and find one or more active coupons for the
 promotion that have a coupon code equal to the one in the order. When we find a valid coupon,
 we attach it to the promotion.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>order</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the order coupon code matches a valid active coupon for the promotion.
         Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkCoupon(com.konakart.app.Promotion, java.lang.String[])"><!-- --></A><H3>
checkCoupon</H3>
<PRE>
protected int <B>checkCoupon</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                          java.lang.String[]&nbsp;coupons)
                   throws com.workingdogs.village.DataSetException,
                          org.apache.torque.TorqueException</PRE>
<DL>
<DD>If the promotion requires a coupon, we try and find one or more active coupons for the
 promotion that have a coupon code equal to one of the ones the array. When we find a valid
 coupon, we attach it to the promotion.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>coupons</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the coupon code matches a valid active coupon for the promotion.
         Otherwise a negative number.
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkExpression(com.konakart.app.Promotion, int)"><!-- --></A><H3>
checkExpression</H3>
<PRE>
protected int <B>checkExpression</B>(<A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>&nbsp;prm,
                              int&nbsp;customerId)
                       throws java.lang.Exception</PRE>
<DL>
<DD>We check to see whether the expression evaluates to TRUE
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prm</CODE> - <DD><CODE>customerId</CODE> - 
<DT><B>Returns:</B><DD>Returns 0 if the expression evaluates to TRUE or doesn't exist. Otherwise a negative
         number.
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPromotionsPerOrderTotalCode(java.lang.String)"><!-- --></A><H3>
getPromotionsPerOrderTotalCode</H3>
<PRE>
protected <A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[] <B>getPromotionsPerOrderTotalCode</B>(java.lang.String&nbsp;orderTotalCode)
                                              throws com.workingdogs.village.DataSetException,
                                                     org.apache.torque.TorqueException</PRE>
<DL>
<DD>The promotions related to the orderTotalCode passed in as a parameter, are fetched from the
 database. They are then added to the return array if they are active.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>orderTotalCode</CODE> - 
<DT><B>Returns:</B><DD>Returns an array of promotion objects
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="updatePromotionUsage(com.konakart.app.Order)"><!-- --></A><H3>
updatePromotionUsage</H3>
<PRE>
public void <B>updatePromotionUsage</B>(<A HREF="../../../com/konakart/app/Order.html" title="class in com.konakart.app">Order</A>&nbsp;order)
                          throws org.apache.torque.TorqueException,
                                 com.workingdogs.village.DataSetException</PRE>
<DL>
<DD>If the order has any associated coupons we iterate through the coupons and increment the
 timesUsed attribute. If the order has any associated promotions that were linked to the
 customer directly through the promotion_to_customer table, then we retrieve these records and
 increment the timesUsed attribute.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#updatePromotionUsage(com.konakart.app.Order)">updatePromotionUsage</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>order</CODE> - 
<DT><B>Throws:</B>
<DD><CODE>org.apache.torque.TorqueException</CODE>
<DD><CODE>com.workingdogs.village.DataSetException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="setPromotionCriteriaWithStandardAttributes(com.konakart.db.KKCriteria)"><!-- --></A><H3>
setPromotionCriteriaWithStandardAttributes</H3>
<PRE>
protected void <B>setPromotionCriteriaWithStandardAttributes</B>(<A HREF="../../../com/konakart/db/KKCriteria.html" title="class in com.konakart.db">KKCriteria</A>&nbsp;c)</PRE>
<DL>
<DD>Set the criteria object with all of the attributes for a promotion
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>c</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="setCouponCriteriaWithStandardAttributes(com.konakart.db.KKCriteria)"><!-- --></A><H3>
setCouponCriteriaWithStandardAttributes</H3>
<PRE>
protected void <B>setCouponCriteriaWithStandardAttributes</B>(<A HREF="../../../com/konakart/db/KKCriteria.html" title="class in com.konakart.db">KKCriteria</A>&nbsp;c)</PRE>
<DL>
<DD>Set the criteria object with all of the attributes for a coupon
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>c</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getPromotionIdForGiftCertificate(com.konakart.appif.OrderProductIf)"><!-- --></A><H3>
getPromotionIdForGiftCertificate</H3>
<PRE>
public int <B>getPromotionIdForGiftCertificate</B>(<A HREF="../../../com/konakart/appif/OrderProductIf.html" title="interface in com.konakart.appif">OrderProductIf</A>&nbsp;op)
                                     throws <A HREF="../../../com/konakart/app/KKException.html" title="class in com.konakart.app">KKException</A>,
                                            org.apache.torque.TorqueException,
                                            com.workingdogs.village.DataSetException</PRE>
<DL>
<DD>Get the promotion id for an order product object containing a gift certificate. A negative id
 is returned if a promotion doesn't exist.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getPromotionIdForGiftCertificate(com.konakart.appif.OrderProductIf)">getPromotionIdForGiftCertificate</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>op</CODE> - 
<DT><B>Returns:</B><DD>Returns the id of the promotion or -1 if a promotion doesn't exist.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../com/konakart/app/KKException.html" title="class in com.konakart.app">KKException</A></CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE>
<DD><CODE>com.workingdogs.village.DataSetException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPromotionIdForGiftCertificate(int, int, int)"><!-- --></A><H3>
getPromotionIdForGiftCertificate</H3>
<PRE>
protected int <B>getPromotionIdForGiftCertificate</B>(int&nbsp;productId,
                                               int&nbsp;productOptionId,
                                               int&nbsp;productOptionValueId)
                                        throws org.apache.torque.TorqueException,
                                               com.workingdogs.village.DataSetException</PRE>
<DL>
<DD>Protected method for common code to get the promotion id of a promotion connected to a gift
 certificate. There should only be one promotion.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>productId</CODE> - <DD><CODE>productOptionId</CODE> - <DD><CODE>productOptionValueId</CODE> - 
<DT><B>Returns:</B><DD>Returns the id of the promotion
<DT><B>Throws:</B>
<DD><CODE>org.apache.torque.TorqueException</CODE>
<DD><CODE>com.workingdogs.village.DataSetException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="insertCoupon(com.konakart.appif.CouponIf, int)"><!-- --></A><H3>
insertCoupon</H3>
<PRE>
public int <B>insertCoupon</B>(<A HREF="../../../com/konakart/appif/CouponIf.html" title="interface in com.konakart.appif">CouponIf</A>&nbsp;coupon,
                        int&nbsp;promotionId)
                 throws java.lang.Exception</PRE>
<DL>
<DD>Insert a coupon and associate it with the promotion referenced by promotionId. If the
 promotionId is a negative number then no association is done.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#insertCoupon(com.konakart.appif.CouponIf, int)">insertCoupon</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>coupon</CODE> - <DD><CODE>promotionId</CODE> - 
<DT><B>Returns:</B><DD>Returns the couponId
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="validateCoupon(com.konakart.appif.CouponIf)"><!-- --></A><H3>
validateCoupon</H3>
<PRE>
protected void <B>validateCoupon</B>(<A HREF="../../../com/konakart/appif/CouponIf.html" title="interface in com.konakart.appif">CouponIf</A>&nbsp;coupon)
                       throws <A HREF="../../../com/konakart/app/KKException.html" title="class in com.konakart.app">KKException</A></PRE>
<DL>
<DD>Used to validate a coupon before inserting
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>coupon</CODE> - 
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../com/konakart/app/KKException.html" title="class in com.konakart.app">KKException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="checkCoupon(java.lang.String)"><!-- --></A><H3>
checkCoupon</H3>
<PRE>
public int <B>checkCoupon</B>(java.lang.String&nbsp;couponCode)
                throws com.workingdogs.village.DataSetException,
                       org.apache.torque.TorqueException</PRE>
<DL>
<DD>This method is used to verify whether a coupon code actually exists and if it does, whether
 the coupon is still active. Valid return values for this method are:
 <ul>
 <li>com.konakart.bl.PromotionMgr.COUPON_DOESNT_EXIST - The coupon code does not exist.</li>
 <li>com.konakart.bl.PromotionMgr.COUPON_EXISTS_ACTIVE - The coupon code does exist and the
 coupon is still active.</li>
 <li>com.konakart.bl.PromotionMgr.COUPON_EXISTS_INACTIVE - The coupon code does exist but the
 coupon is no longer active since the number of times it has been used has reached the maximum
 number of times allowed.</li>
 </ul>
 Even if the coupon exists and is active, it won't actually do anything if it isn't connected
 to a valid promotion and any rules associated with the promotion are also satisfied. However,
 this method may still be used to at least warn a customer that he may have mistyped the
 coupon code or that it is no longer valid.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#checkCoupon(java.lang.String)">checkCoupon</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>couponCode</CODE> - The coupon code
<DT><B>Returns:</B><DD>Returns an integer
<DT><B>Throws:</B>
<DD><CODE>com.workingdogs.village.DataSetException</CODE>
<DD><CODE>org.apache.torque.TorqueException</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPromotionsPerProducts(java.lang.String, int, com.konakart.appif.ProductIf[], com.konakart.appif.PromotionIf[], java.lang.String[], com.konakart.appif.PromotionOptionsIf)"><!-- --></A><H3>
getPromotionsPerProducts</H3>
<PRE>
public <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>[] <B>getPromotionsPerProducts</B>(java.lang.String&nbsp;sessionId,
                                            int&nbsp;customerId,
                                            <A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>[]&nbsp;products,
                                            <A HREF="../../../com/konakart/appif/PromotionIf.html" title="interface in com.konakart.appif">PromotionIf</A>[]&nbsp;promotions,
                                            java.lang.String[]&nbsp;couponCodes,
                                            <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)
                                     throws java.lang.Exception</PRE>
<DL>
<DD>This method is used to calculate a discount on individual products so that the discount can
 be displayed without having to add the product to the cart.<br>
 The method receives an array of products and returns an array of products with attached
 PromotionResult objects that contain the results of one or more of the promotions passed in
 as a parameter. The PromotionResult contains the value of the discount, whether it is an
 amount or a percentage discount and also information regarding the promotion it applies to.
 If a product has an array of ProductQuantity objects (one for each SKU) each one of these may
 have an array of PromotionResult objects since a promotion may only apply to one product
 configuration and not to another (i.e. blue shirt and not red shirt).<br>
 The PromotionOptions object can be configured so that the values of the promotions for a
 product are subtracted from the product price. The options allow you to set rules that
 determine whether in this case the promotions need to be cumulative or whether the largest or
 smallest should be chosen. The calculation is only made for products with a single array of
 PromotionResult objects. It is not calculated for products that have an array of
 PromotionResult objects for each ProductQuantity.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getPromotionsPerProducts(java.lang.String, int, com.konakart.appif.ProductIf[], com.konakart.appif.PromotionIf[], java.lang.String[], com.konakart.appif.PromotionOptionsIf)">getPromotionsPerProducts</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sessionId</CODE> - Only used if the customer is logged in. Otherwise set to null.<DD><CODE>customerId</CODE> - If the sessionId is set to null then the customerId should contain the id of the
            temporary user which is a negative number. The temporary user id can be used for
            evaluating expression rules.<DD><CODE>products</CODE> - An array of products to be processed<DD><CODE>promotions</CODE> - The promotions which will be applied to the products if all rules are matched.<DD><CODE>couponCodes</CODE> - Coupon codes to use. If none of the promotions require coupons, it should be set
            to null<DD><CODE>options</CODE> - An object containing information to configure the calculation for applying one or
            more promotion results to the product price.
<DT><B>Returns:</B><DD>Returns the same array of products passed in as a parameter with attached
         PromotionResult objects if applicable
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="processPrice(com.konakart.appif.ProductIf, com.konakart.appif.PromotionOptionsIf)"><!-- --></A><H3>
processPrice</H3>
<PRE>
protected void <B>processPrice</B>(<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod,
                            <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)</PRE>
<DL>
<DD>We apply the discount to a product, taking into consideration the rules to decide which
 promotion discount to select
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prod</CODE> - <DD><CODE>options</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="applyDiscount(com.konakart.appif.ProductIf, com.konakart.appif.PromotionResultIf, com.konakart.appif.PromotionOptionsIf)"><!-- --></A><H3>
applyDiscount</H3>
<PRE>
protected void <B>applyDiscount</B>(<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod,
                             <A HREF="../../../com/konakart/appif/PromotionResultIf.html" title="interface in com.konakart.appif">PromotionResultIf</A>&nbsp;promResult,
                             <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)</PRE>
<DL>
<DD>Apply the promotion discount to a product
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prod</CODE> - <DD><CODE>promResult</CODE> - <DD><CODE>options</CODE> - </DL>
</DD>
</DL>
<HR>

<A NAME="getPromotionResultArray(com.konakart.appif.PromotionResultIf[], com.konakart.app.PromotionResult)"><!-- --></A><H3>
getPromotionResultArray</H3>
<PRE>
protected <A HREF="../../../com/konakart/appif/PromotionResultIf.html" title="interface in com.konakart.appif">PromotionResultIf</A>[] <B>getPromotionResultArray</B>(<A HREF="../../../com/konakart/appif/PromotionResultIf.html" title="interface in com.konakart.appif">PromotionResultIf</A>[]&nbsp;currentArray,
                                                      <A HREF="../../../com/konakart/app/PromotionResult.html" title="class in com.konakart.app">PromotionResult</A>&nbsp;newResult)</PRE>
<DL>
<DD>Utility method to add a PromotionResult object on to the end of an array
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>currentArray</CODE> - <DD><CODE>newResult</CODE> - 
<DT><B>Returns:</B><DD>Returns an array of PromotionResult objects</DL>
</DD>
</DL>
<HR>

<A NAME="getOrderProductsFromProduct(com.konakart.appif.ProductIf)"><!-- --></A><H3>
getOrderProductsFromProduct</H3>
<PRE>
protected <A HREF="../../../com/konakart/app/OrderProduct.html" title="class in com.konakart.app">OrderProduct</A>[] <B>getOrderProductsFromProduct</B>(<A HREF="../../../com/konakart/appif/ProductIf.html" title="interface in com.konakart.appif">ProductIf</A>&nbsp;prod)
                                              throws java.lang.Exception</PRE>
<DL>
<DD>Creates OrderProducts from a product so that we can reuse the checkProduct() method.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>prod</CODE> - 
<DT><B>Returns:</B><DD>Returns an array of OrderProduct objects
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getCustomerId(java.lang.String, int)"><!-- --></A><H3>
getCustomerId</H3>
<PRE>
protected int <B>getCustomerId</B>(java.lang.String&nbsp;sessionId,
                            int&nbsp;customerId)
                     throws java.lang.Exception</PRE>
<DL>
<DD>If the sessionId is null, we check the customerId to ensure that it is negative. If it is
 negative, this means that it is a non registered customer or a customer that hasn't logged in
 yet and so there is no customer mapped to the session id. Otherwise we ensure that the
 sessionId is valid and we don't use the customerId because we get the id from the session.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>sessionId</CODE> - <DD><CODE>customerId</CODE> - 
<DT><B>Returns:</B><DD>Returns the customerId that should be used by the caller
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="refreshConfigs()"><!-- --></A><H3>
refreshConfigs</H3>
<PRE>
public void <B>refreshConfigs</B>()
                    throws java.lang.Exception</PRE>
<DL>
<DD><B>Description copied from interface: <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#refreshConfigs()">PromotionMgrIf</A></CODE></B></DD>
<DD>Refresh the configuration of the Promotion manager
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#refreshConfigs()">refreshConfigs</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getCouponsPerCode(java.lang.String, com.konakart.appif.CouponOptionsIf)"><!-- --></A><H3>
getCouponsPerCode</H3>
<PRE>
public <A HREF="../../../com/konakart/app/Coupon.html" title="class in com.konakart.app">Coupon</A>[] <B>getCouponsPerCode</B>(java.lang.String&nbsp;couponCode,
                                  <A HREF="../../../com/konakart/appif/CouponOptionsIf.html" title="interface in com.konakart.appif">CouponOptionsIf</A>&nbsp;options)
                           throws java.lang.Exception</PRE>
<DL>
<DD>Returns an array of coupons for the coupon code passed in as a parameter.
 <p>
 The options object allows you to specify that only active coupons should be returned.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getCouponsPerCode(java.lang.String, com.konakart.appif.CouponOptionsIf)">getCouponsPerCode</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>couponCode</CODE> - <DD><CODE>options</CODE> - Allows you to specify that only active coupons should be returned
<DT><B>Returns:</B><DD>Returns an array of coupons. An empty array is returned if no coupons are available.
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getCouponPerId(int, com.konakart.appif.CouponOptionsIf)"><!-- --></A><H3>
getCouponPerId</H3>
<PRE>
public <A HREF="../../../com/konakart/app/Coupon.html" title="class in com.konakart.app">Coupon</A> <B>getCouponPerId</B>(int&nbsp;couponId,
                             <A HREF="../../../com/konakart/appif/CouponOptionsIf.html" title="interface in com.konakart.appif">CouponOptionsIf</A>&nbsp;options)
                      throws java.lang.Exception</PRE>
<DL>
<DD>Returns a coupon for the coupon id passed in as a parameter.
 <p>
 The options object allows you to specify that only active coupons should be returned.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getCouponPerId(int, com.konakart.appif.CouponOptionsIf)">getCouponPerId</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>couponId</CODE> - <DD><CODE>options</CODE> - Allows you to specify that only active coupons should be returned
<DT><B>Returns:</B><DD>Returns a coupon object or null if a coupon isn't available.
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<HR>

<A NAME="getPromotionsPerCoupon(java.lang.String, int, com.konakart.appif.PromotionOptionsIf)"><!-- --></A><H3>
getPromotionsPerCoupon</H3>
<PRE>
public <A HREF="../../../com/konakart/app/Promotion.html" title="class in com.konakart.app">Promotion</A>[] <B>getPromotionsPerCoupon</B>(java.lang.String&nbsp;couponCode,
                                          int&nbsp;couponId,
                                          <A HREF="../../../com/konakart/appif/PromotionOptionsIf.html" title="interface in com.konakart.appif">PromotionOptionsIf</A>&nbsp;options)
                                   throws java.lang.Exception</PRE>
<DL>
<DD>This method is used to return an array of promotions associated with the coupon(s) identified
 by the input parameters. The method will either use the couponCode or the couponId parameter.
 The couponCode is used if not null, otherwise couponId is used. Note that multiple coupons
 may share the same coupon code.
 <p>
 The PromotionOptions may be used to control whether or not to use expired coupons and whether
 or not to return expired promotions. The default is to not check whether coupons or
 promotions have expired.
 <p>
 If no promotions are found, an empty array is returned.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html#getPromotionsPerCoupon(java.lang.String, int, com.konakart.appif.PromotionOptionsIf)">getPromotionsPerCoupon</A></CODE> in interface <CODE><A HREF="../../../com/konakart/blif/PromotionMgrIf.html" title="interface in com.konakart.blif">PromotionMgrIf</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>couponCode</CODE> - The code of the coupon<DD><CODE>couponId</CODE> - The unique numeric id of the coupon<DD><CODE>options</CODE> - A PromotionOptions object to control whether or not to use expired coupons and
            whether or not to return expired promotions
<DT><B>Returns:</B><DD>Returns an array of promotions
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE></DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../com/konakart/bl/ProductMgrEE.html" title="class in com.konakart.bl"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../com/konakart/bl/PromotionMgr.StaticData.html" title="class in com.konakart.bl"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../index.html?com/konakart/bl/PromotionMgr.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="PromotionMgr.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;<A HREF="#nested_class_summary">NESTED</A>&nbsp;|&nbsp;<A HREF="#field_summary">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_summary">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;<A HREF="#field_detail">FIELD</A>&nbsp;|&nbsp;<A HREF="#constructor_detail">CONSTR</A>&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &copy; 2011 DS Data Systems UK Ltd.
</BODY>
</HTML>
